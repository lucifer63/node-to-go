module.exports=function(a,b){var c,d,e,f,g,h,i,j={},k=new RegExp("\\*","g"),l=new RegExp("\\?","g"),m="[ -]*",n="[ -]{1}";for(g in b){g=b[g],g.from&&(c=[],(-1!=g.from.indexOf("*")||-1!=g.from.indexOf("?"))&&(e=new RegExp("^"+g.from.replace(k,m).replace(l,n)+"$"))),g.to&&(d=[],(-1!=g.to.indexOf("*")||-1!=g.to.indexOf("?"))&&(f=new RegExp("^"+g.to.replace(k,m).replace(l,n)+"$")));for(h in a)i=h,j[i]||(j[i]=[]),h=a[i],(!c||-1!=c.indexOf(h.from)||e&&e.test(h.from)||h.from===g.from)&&(!d||-1!=d.indexOf(h.to)||f&&f.test(h.to)||h.to===g.to)&&(j[i].push(g.action),c&&c.push(h.from),d&&d.push(h.to));c=d=e=f=null}return j};